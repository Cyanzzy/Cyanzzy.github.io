---
title: DL-MULI-2-线性代数
date: 2023-09-08 12:46:57
tags: 
  - DL
categories: 
  - Science
---

# 标量

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-04.png)

 标量由只有一个元素的张量表示。 下面的代码将实例化两个标量，并执行一些熟悉的算术运算，即加法、乘法、除法和指数。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-90.png)

# 向量

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-05.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-06.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-07.png)

 向量可以被视为标量值组成的列表。 这些标量值被称为向量的`元素`（element）或`分量`（component）。 当向量表示数据集中的样本时，它们的值具有一定的现实意义 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-91.png)

 我们可以使用下标来引用向量的任一元素，例如可以通过 $x_i$ 来引用第 $i$ 个元素。 注意，元素 $x_i$ 是一个标量，所以我们在引用它时不会加粗，大量文献认为列向量是向量的默认方向 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-92.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-93.png)

> 长度、维度和形状

 向量只是一个数字数组，就像每个数组都有一个长度一样，每个向量也是如此。 在数学表示法中，如果我们想说一个向量 $x$ 由 $n$ 个实值标量组成， 可以将其表示为 $x∈\R^n$ 。 向量的长度通常称为向量的`维度`（dimension）。 

 与普通的Python数组一样，我们可以通过调用Python的内置`len()`函数来访问张量的长度。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-94.png)

 当用张量表示一个向量（只有一个轴）时，我们也可以通过`.shape`属性访问向量的长度。 形状（shape）是一个元素组，列出了张量沿每个轴的长度（维数）。 对于只有一个轴的张量，形状只有一个元素。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-95.png)



#  矩阵

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-96.png)

当调用函数来实例化张量时， 我们可以通过指定两个分量 $m$ 和$n$ 来创建一个形状为 $m×n$ 的矩阵。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-97.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-98.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-99.png)



![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-08.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-09.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-10.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-11.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-12.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-13.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-14.png)



# 张量

 张量（本小节中的“张量”指代数对象）是描述具有任意数量轴的$n$ 维数组的通用方法。 例如，向量是一阶张量，矩阵是二阶张量， 张量用特殊字体的大写字母表示 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-100.png)

> 张量算法的基本性质

 标量、向量、矩阵和任意数量轴的张量（本小节中的“张量”指代数对象）有一些实用的属性。 

 例如，从按元素操作的定义中可以注意到，任何按元素的一元运算都不会改变其操作数的形状。 同样，给定具有相同形状的任意两个张量，任何按元素二元运算的结果都将是相同形状的张量。 

 例如，将两个相同形状的矩阵相加，会在这两个矩阵上执行元素加法。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-101.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-102.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-103.png)

 将张量乘以或加上一个标量不会改变张量的形状，其中张量的每个元素都将与标量相加或相乘。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-104.png)

# 降维

 我们可以对任意张量进行的一个有用的操作是计算其元素的和。 数学表示法使用$\sum$符号表示求和。 为了表示长度为 $d$ 的向量中元素的总和，可以记为 $\sum_{i=1}^{d}{x_i}$

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-105.png)

 我们可以表示任意形状张量的元素和。 例如，矩阵 $A$ 中元素的和可以记为 $\sum_{i=1}^{m}\sum_{j=1}^{n}{a_{ij}}$

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-106.png)

 默认情况下，调用求和函数会沿所有的轴降低张量的维度，使它变为一个标量。 我们还可以指定张量沿哪一个轴来通过求和降低维度。

 以矩阵为例，为了通过求和所有行的元素来降维（轴0），可以在调用函数时指定`axis=0`。 **由于输入矩阵沿0轴降维以生成输出向量，因此输入轴0的维数在输出形状中消失。** 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-107.png)

 指定`axis=1`将通过汇总所有列的元素降维（轴1）。因此，输入轴1的维数在输出形状中消失。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-108.png)

 沿着行和列对矩阵求和，等价于对矩阵的所有元素进行求和。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-109.png)

 一个与求和相关的量是*平均值*（mean或average）。 我们通过将总和除以元素总数来计算平均值。 在代码中，我们可以调用函数来计算任意形状张量的平均值。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-110.png)

 同样，计算平均值的函数也可以沿指定轴降低张量的维度。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-111.png)



#  非降维求和

 但是，有时在调用函数来计算总和或均值时保持轴数不变会很有用。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-112.png)

 例如，由于`sum_A`在对每行进行求和后仍保持两个轴，我们可以通过广播将`A`除以`sum_A`。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-113.png)

 如果我们想沿某个轴计算`A`元素的累积总和， 比如`axis=0`（按行计算），可以调用`cumsum`函数。 此函数不会沿任何轴降低输入张量的维度。 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-114.png)

# 点积

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-115.png)

 注意，我们可以通过执行按元素乘法，然后进行求和来表示两个向量的点积： 

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-116.png)

# 矩阵-向量积

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-117.png)

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-118.png)



# 矩阵-矩阵乘法

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-119.png)



![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-120.png)

# 范数

![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-121.png)



![](https://cyan-images.oss-cn-shanghai.aliyuncs.com/images/deep-learning-20230716-122.png)

> 补充

```python
a = torch.ones(2,5,4)
a.shape
torch.Size([2, 5, 4])

# 按维度1进行shape
a.sum(axis=1).shape
torch.Size([2, 4])

# 按维度1进行shape， keepdims=True
a.sum(axis=1, keepdims=True).shape
torch.Size([2, 1, 4])
```

